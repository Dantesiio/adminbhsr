(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[849],{7418:function(e,s,t){Promise.resolve().then(t.bind(t,7304))},7304:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return o}});var r=t(8947),a=t(3081),l=t(9045),i=t(6834),d=t(1518),n=t(3537);function o(e){var s,t,o,c;let{params:x}=e,m=(0,i.useRouter)(),u=(0,i.useSearchParams)().get("role")||"AUTORIZADOR",[h,p]=(0,a.useState)(null),[b,g]=(0,a.useState)(!0),[f,j]=(0,a.useState)(""),[v,N]=(0,a.useState)(!1);(0,a.useEffect)(()=>{let e=!0;return(async()=>{try{if(g(!0),await new Promise(e=>setTimeout(e,300)),!e)return;p({id:x.id,code:"RQ-0001",title:"Compra de bolsas",status:"EN_AUTORIZACION",description:"Bolsas para proyecto ECHO",total:25e5,currency:"COP",project:{name:"ECHO Bolsas 06/2025"},requester:{name:"Solicitante Demo"},comparison:{chosen:{name:"Proveedor A"}}})}catch(e){console.error("Error loading data:",e)}finally{e&&g(!1)}})(),()=>{e=!1}},[x.id]);let y=async e=>{if(!f.trim()){alert("Por favor agregue un comentario");return}N(!0);try{await new Promise(e=>setTimeout(e,600)),alert("APROBADA"===e?"Requisici\xf3n aprobada":"Requisici\xf3n rechazada"),m.push("/dashboard?role=".concat(u))}catch(e){console.error("Error processing approval:",e),alert("Ocurri\xf3 un error al registrar la decisi\xf3n")}finally{N(!1)}};if(b)return(0,r.jsx)(l.default,{currentRole:u,children:(0,r.jsx)("div",{className:"flex h-64 items-center justify-center text-gray-500",children:"Cargando..."})});if(!h)return(0,r.jsx)(l.default,{currentRole:u,children:(0,r.jsx)("div",{className:"text-center text-gray-500",children:"Requisici\xf3n no encontrada"})});let w=(0,n.pd)(h.status);return(0,r.jsx)(l.default,{currentRole:u,children:(0,r.jsxs)("div",{className:"space-y-8",children:[(0,r.jsxs)("header",{className:"rounded-3xl bg-gradient-to-r from-orange-500 via-red-500 to-rose-500 p-8 text-white shadow-lg",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-4 md:flex-row md:items-start md:justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.4em] text-white/70",children:"Autorizaci\xf3n"}),(0,r.jsx)("h1",{className:"mt-2 text-3xl font-bold leading-tight",children:"Revisar y aprobar RQ"}),(0,r.jsxs)("p",{className:"mt-2 max-w-2xl text-sm text-white/80",children:[h.code," â€¢ ",h.project.name]}),w&&(0,r.jsx)("p",{className:"mt-1 max-w-xl text-xs text-white/70",children:w.description})]}),(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,r.jsx)("button",{onClick:()=>m.push("/rq/".concat(x.id,"?role=").concat(u)),className:"inline-flex items-center gap-2 rounded-full border border-white/20 bg-white/10 px-5 py-2 text-sm font-semibold text-white transition hover:bg-white/20",children:"Ver detalles completos"}),(0,r.jsx)("button",{onClick:()=>m.push("/dashboard?role=".concat(u)),className:"inline-flex items-center gap-2 rounded-full bg-white px-5 py-2 text-sm font-semibold text-red-600 shadow hover:shadow-lg",children:"Volver al dashboard"})]})]}),(0,r.jsx)("div",{className:"mt-6",children:(0,r.jsx)(d.N,{currentStatus:h.status,compact:!0})})]}),(0,r.jsxs)("section",{className:"grid gap-6 lg:grid-cols-[2fr_1fr]",children:[(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm",children:[(0,r.jsx)("h2",{className:"mb-4 text-lg font-medium text-slate-900",children:"Resumen de la requisici\xf3n"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm font-medium text-gray-700",children:"Proyecto"}),(0,r.jsx)("p",{className:"text-sm text-gray-900",children:h.project.name})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm font-medium text-gray-700",children:"Solicitante"}),(0,r.jsx)("p",{className:"text-sm text-gray-900",children:h.requester.name})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm font-medium text-gray-700",children:"Proveedor recomendado"}),(0,r.jsx)("p",{className:"text-sm text-gray-900",children:null!==(c=null===(t=h.comparison)||void 0===t?void 0:null===(s=t.chosen)||void 0===s?void 0:s.name)&&void 0!==c?c:"N/A"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm font-medium text-gray-700",children:"Valor total estimado"}),(0,r.jsxs)("p",{className:"text-lg font-semibold text-gray-900",children:[h.currency," ",null===(o=h.total)||void 0===o?void 0:o.toLocaleString("es-CO")]})]})]}),h.description&&(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsx)("div",{className:"text-sm font-medium text-gray-700",children:"Descripci\xf3n"}),(0,r.jsx)("p",{className:"text-sm text-gray-900",children:h.description})]})]}),(0,r.jsxs)("div",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm",children:[(0,r.jsx)("h2",{className:"mb-4 text-lg font-medium text-slate-900",children:"Lista de verificaci\xf3n"}),(0,r.jsx)("div",{className:"space-y-3",children:[{label:"Presupuesto disponible",description:"Validar que el proyecto tiene recursos suficientes para la compra"},{label:"Justificaci\xf3n adecuada",description:"Confirmar que la necesidad y el proveedor seleccionado est\xe1n bien soportados"},{label:"Proveedor calificado",description:"Verificar antecedentes, cumplimiento de auditor\xedas y documentos al d\xeda"},{label:"Precios de mercado",description:"Comparar contra hist\xf3rico y cotizaciones alternativas"}].map(e=>(0,r.jsxs)("label",{className:"flex items-start space-x-3 rounded-2xl border border-slate-200 p-3",children:[(0,r.jsx)("input",{type:"checkbox",className:"mt-1 h-4 w-4 rounded border-gray-300 text-red-500 focus:ring-red-400"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-medium text-gray-900",children:e.label}),(0,r.jsx)("div",{className:"text-sm text-gray-500",children:e.description})]})]},e.label))})]}),(0,r.jsxs)("div",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm",children:[(0,r.jsx)("h2",{className:"mb-4 text-lg font-medium text-slate-900",children:"Decisi\xf3n de autorizaci\xf3n"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"approvalComment",className:"mb-2 block text-sm font-medium text-gray-700",children:"Comentarios de la autorizaci\xf3n *"}),(0,r.jsx)("textarea",{id:"approvalComment",value:f,onChange:e=>j(e.target.value),className:"h-24 w-full rounded-md border px-3 py-2",placeholder:"Agregue sus comentarios sobre la autorizaci\xf3n...",required:!0})]}),(0,r.jsxs)("div",{className:"grid gap-3 md:grid-cols-2",children:[(0,r.jsx)("button",{type:"button",onClick:()=>y("APROBADA"),disabled:v||!f.trim(),className:"flex items-center justify-center gap-2 rounded-xl bg-green-600 px-4 py-3 text-sm font-semibold text-white transition hover:bg-green-700 disabled:cursor-not-allowed disabled:bg-gray-400",children:v?"Procesando...":"Aprobar RQ"}),(0,r.jsx)("button",{type:"button",onClick:()=>y("RECHAZADA"),disabled:v||!f.trim(),className:"flex items-center justify-center gap-2 rounded-xl bg-red-600 px-4 py-3 text-sm font-semibold text-white transition hover:bg-red-700 disabled:cursor-not-allowed disabled:bg-gray-400",children:v?"Procesando...":"Rechazar RQ"})]})]})]})]}),(0,r.jsxs)("aside",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"rounded-3xl border border-white/20 bg-white/40 p-6 text-sm text-white shadow backdrop-blur",style:{background:"linear-gradient(135deg, rgba(255,255,255,0.2), rgba(255,255,255,0.05))"},children:[(0,r.jsx)("h3",{className:"text-sm font-semibold uppercase tracking-widest text-white",children:"Resumen ejecutivo"}),(0,r.jsx)("p",{className:"mt-3 text-xs leading-relaxed text-white/80",children:"Revisa montos, el proveedor recomendado y los documentos soporte. Si tienes dudas, deja comentarios claros para el equipo de Compras."})]}),(0,r.jsxs)("div",{className:"rounded-3xl border border-slate-200 bg-white p-6 text-sm text-slate-600 shadow-sm",children:[(0,r.jsx)("h3",{className:"text-sm font-semibold uppercase tracking-widest text-slate-500",children:"Documentos clave"}),(0,r.jsxs)("ul",{className:"mt-3 space-y-2",children:[(0,r.jsxs)("li",{className:"flex items-center justify-between rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,r.jsx)("span",{className:"text-xs font-semibold text-slate-700",children:"Comparativo.pdf"}),(0,r.jsx)("button",{className:"text-xs font-semibold text-blue-600 transition hover:text-blue-800",children:"Ver"})]}),(0,r.jsxs)("li",{className:"flex items-center justify-between rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,r.jsx)("span",{className:"text-xs font-semibold text-slate-700",children:"Cotizaci\xf3n Proveedor A"}),(0,r.jsx)("button",{className:"text-xs font-semibold text-blue-600 transition hover:text-blue-800",children:"Ver"})]})]})]})]})]})]})})}},1518:function(e,s,t){"use strict";t.d(s,{N:function(){return i}});var r=t(8947),a=t(1960),l=t(3537);function i(e){let{currentStatus:s,compact:t=!1}=e,i=(0,l.Pe)(),d=function(e){if(!e)return -1;let s=e.toUpperCase(),t=l.bW.indexOf(s);return t>=0?t:"RECHAZADA"===s?l.bW.indexOf("EN_AUTORIZACION"):-1}(s),n=(null==s?void 0:s.toUpperCase())==="RECHAZADA";return(0,r.jsxs)("div",{className:(0,a.Z)("space-y-4",t&&"space-y-2"),children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-semibold text-gray-700",children:"Flujo del proceso"}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:s?"Estado actual: ".concat(s.replace(/_/g," ")):"Sin estado asignado"})]}),0===i.length?(0,r.jsxs)("span",{className:"inline-flex items-center gap-1 text-xs font-medium text-green-700 bg-green-100 px-2 py-1 rounded-full",children:[(0,r.jsx)("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Flujo validado"]}):(0,r.jsxs)("span",{className:"inline-flex items-center gap-1 text-xs font-medium text-red-700 bg-red-100 px-2 py-1 rounded-full",children:[(0,r.jsx)("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01M12 5a7 7 0 100 14 7 7 0 000-14z"})}),"Flujo requiere ajustes"]})]}),(0,r.jsx)("div",{className:(0,a.Z)("max-w-full overflow-x-auto pb-1 [-ms-overflow-style:none] [scrollbar-width:none] [&::-webkit-scrollbar]:hidden"),children:(0,r.jsx)("div",{className:(0,a.Z)("relative flex flex-col md:flex-row md:flex-wrap",t?"gap-3 md:gap-4":"gap-4 md:gap-6"),children:l.bW.map((e,s)=>{let i=l.A9[e],o=d>s,c=d===s&&!n;return(0,r.jsxs)("div",{className:(0,a.Z)("flex-1 min-w-[140px] md:flex-[1_1_180px]"),children:[(0,r.jsxs)("div",{className:(0,a.Z)("flex items-center gap-3 rounded-2xl border px-4 py-3 shadow-sm transition-colors",c&&"border-blue-500 bg-blue-50 text-blue-900 shadow",o&&!c&&"border-green-500 bg-green-50 text-green-900",!c&&!o&&"border-gray-200 bg-white text-gray-600"),children:[(0,r.jsx)("div",{className:(0,a.Z)("flex h-10 w-10 items-center justify-center rounded-full border-2 text-sm font-semibold",c&&"border-blue-500 bg-blue-100 text-blue-700",o&&!c&&"border-green-500 bg-green-100 text-green-700",!c&&!o&&"border-gray-200 bg-gray-100 text-gray-500"),children:s+1}),(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wider",children:i.label}),(0,r.jsx)("span",{className:"text-[11px] text-gray-500",children:i.actor})]})]}),(0,r.jsx)("p",{className:(0,a.Z)("mt-2 text-xs leading-relaxed text-gray-500",t&&"hidden md:block"),children:i.description}),n&&"EN_AUTORIZACION"===e&&(0,r.jsxs)("div",{className:"mt-2 inline-flex items-center gap-2 rounded-lg border border-red-200 bg-red-50 px-3 py-2 text-xs text-red-700",children:[(0,r.jsx)("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18.364 5.636a9 9 0 11-12.728 0 9 9 0 0112.728 0zM9 9l6 6m0-6l-6 6"})}),"Rechazada - volver a Compras"]})]},e)})})}),i.length>0&&(0,r.jsxs)("div",{className:"rounded-xl border border-red-200 bg-red-50 px-4 py-3 text-xs text-red-700",children:[(0,r.jsx)("p",{className:"font-semibold mb-1",children:"Inconsistencias detectadas en el workflow:"}),(0,r.jsx)("ul",{className:"list-disc pl-5 space-y-1",children:i.map(e=>(0,r.jsx)("li",{children:e},e))})]})]})}},1960:function(e,s,t){"use strict";s.Z=function(){for(var e,s,t=0,r="",a=arguments.length;t<a;t++)(e=arguments[t])&&(s=function e(s){var t,r,a="";if("string"==typeof s||"number"==typeof s)a+=s;else if("object"==typeof s){if(Array.isArray(s)){var l=s.length;for(t=0;t<l;t++)s[t]&&(r=e(s[t]))&&(a&&(a+=" "),a+=r)}else for(r in s)s[r]&&(a&&(a+=" "),a+=r)}return a}(e))&&(r&&(r+=" "),r+=s);return r}}},function(e){e.O(0,[747,687,45,580,996,744],function(){return e(e.s=7418)}),_N_E=e.O()}]);