(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[716],{6561:function(e,s,t){Promise.resolve().then(t.bind(t,1117))},1117:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return d}});var r=t(8947),a=t(3081),l=t(9045),i=t(6834),n=t(1518),o=t(3537);function d(e){let{params:s}=e,t=(0,i.useRouter)(),d=(0,i.useSearchParams)().get("role")||"COMPRAS",[c,x]=(0,a.useState)(null),[m,h]=(0,a.useState)([]),[p,u]=(0,a.useState)([]),[b,j]=(0,a.useState)(!0),[f,g]=(0,a.useState)(!1),v=(0,a.useCallback)(async()=>{try{j(!0),await new Promise(e=>setTimeout(e,200)),x({id:s.id,code:"RQ-0001",title:"Compra de bolsas",description:"Bolsas para proyecto ECHO",status:"EN_COMPARATIVO",items:[{id:"1",name:"Bolsa 20x30",spec:"Polietileno",qty:1e3,uom:"unidad"},{id:"2",name:"Bolsa 30x40",spec:"Polietileno",qty:500,uom:"unidad"}],project:{name:"ECHO Bolsas 06/2025"}}),h([{id:"1",name:"Proveedor A",nit:"123456789",email:"contacto@proveedora.com"},{id:"2",name:"Proveedor B",nit:"987654321",email:"ventas@proveedorb.com"},{id:"3",name:"Proveedor C",nit:"456789123",email:"cotizaciones@proveedorc.com"}]),u([])}catch(e){console.error("Error loading data:",e)}finally{j(!1)}},[s.id]);if((0,a.useEffect)(()=>{v()},[v]),b)return(0,r.jsx)(l.default,{currentRole:d,children:(0,r.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,r.jsx)("div",{className:"text-gray-500",children:"Cargando..."})})});if(!c)return(0,r.jsx)(l.default,{currentRole:d,children:(0,r.jsx)("div",{className:"text-center text-gray-500",children:"RQ no encontrada"})});let N=(0,o.pd)(c.status);return(0,r.jsx)(l.default,{currentRole:d,children:(0,r.jsxs)("div",{className:"space-y-8",children:[(0,r.jsxs)("header",{className:"rounded-3xl bg-gradient-to-r from-blue-600 via-blue-500 to-indigo-500 p-8 text-white shadow-lg",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-4 md:flex-row md:items-start md:justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.4em] text-white/70",children:"Compras"}),(0,r.jsx)("h1",{className:"mt-2 text-3xl font-bold leading-tight",children:"Gestionar Cotizaciones"}),(0,r.jsxs)("p",{className:"mt-2 max-w-2xl text-sm text-white/80",children:[c.code," • ",c.project.name]}),N&&(0,r.jsx)("p",{className:"mt-1 text-xs text-white/70 max-w-xl",children:N.description})]}),(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,r.jsxs)("button",{onClick:()=>g(!0),className:"inline-flex items-center gap-2 rounded-full bg-white px-5 py-2 text-sm font-semibold text-blue-600 shadow hover:shadow-lg",children:[(0,r.jsx)("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Solicitar Cotizaci\xf3n"]}),p.length>=2&&(0,r.jsxs)("button",{onClick:()=>{if(p.length<2){alert("Se necesitan al menos 2 cotizaciones para crear un comparativo");return}alert("Comparativo creado exitosamente"),t.push("/rq/".concat(s.id,"?role=").concat(d))},className:"inline-flex items-center gap-2 rounded-full border border-white/40 bg-white/10 px-5 py-2 text-sm font-semibold text-white transition hover:bg-white/20",children:[(0,r.jsx)("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m2 6H7a2 2 0 01-2-2V8a2 2 0 012-2h5l2 2h6a2 2 0 012 2v6a2 2 0 01-2 2z"})}),"Crear Comparativo"]})]})]}),(0,r.jsx)("div",{className:"mt-6",children:(0,r.jsx)(n.N,{currentStatus:c.status,compact:!0})})]}),(0,r.jsxs)("section",{className:"grid gap-6 lg:grid-cols-[2fr_1fr]",children:[(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"\xcdtems a Cotizar"}),(0,r.jsx)("p",{className:"mt-1 text-xs text-slate-500",children:"Valida cantidades y especificaciones antes de solicitar al proveedor."}),(0,r.jsx)("div",{className:"mt-4 overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase",children:"Producto"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase",children:"Especificaci\xf3n"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase",children:"Cantidad"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase",children:"Unidad"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:c.items.map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.name}),(0,r.jsx)("td",{className:"px-6 py-4 text-sm text-gray-500",children:e.spec||"-"}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.qty}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.uom||"unidad"})]},e.id))})]})})]}),(0,r.jsxs)("div",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"Cotizaciones Recibidas"}),(0,r.jsx)("p",{className:"text-xs text-slate-500",children:"Registra m\xednimo dos para habilitar el comparativo."})]}),(0,r.jsxs)("div",{className:"rounded-full bg-blue-50 px-3 py-1 text-xs font-semibold text-blue-700",children:[p.length," recibidas"]})]}),0===p.length?(0,r.jsx)("div",{className:"mt-6 rounded-2xl border border-dashed border-blue-200 bg-blue-50/60 p-8 text-center text-sm text-blue-700",children:'A\xfan no se registran cotizaciones. Usa el bot\xf3n "Solicitar Cotizaci\xf3n" para comenzar.'}):(0,r.jsx)("div",{className:"mt-6 space-y-4",children:p.map(e=>{var s,t;return(0,r.jsx)("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-4",children:(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-semibold text-slate-900",children:null===(s=e.supplier)||void 0===s?void 0:s.name}),e.notes&&(0,r.jsx)("p",{className:"mt-1 text-xs text-slate-600",children:e.notes})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsxs)("p",{className:"text-lg font-bold text-slate-900",children:[e.currency," ",null===(t=e.total)||void 0===t?void 0:t.toLocaleString("es-CO")]}),(0,r.jsxs)("p",{className:"text-xs text-slate-500",children:["Recibida ",new Date(e.createdAt).toLocaleDateString("es-CO")]})]})]})},e.id)})})]})]}),(0,r.jsxs)("aside",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"rounded-3xl border border-blue-100 bg-blue-50 p-6 text-sm text-blue-900 shadow-sm",children:[(0,r.jsx)("h3",{className:"text-sm font-semibold uppercase tracking-widest text-blue-700",children:"Checklist del comprador"}),(0,r.jsxs)("ul",{className:"mt-3 space-y-2",children:[(0,r.jsxs)("li",{className:"flex items-start gap-2",children:[(0,r.jsx)("svg",{className:"mt-1 h-4 w-4 flex-shrink-0 text-blue-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Confirma que los proveedores recibieron la solicitud."]}),(0,r.jsxs)("li",{className:"flex items-start gap-2",children:[(0,r.jsx)("svg",{className:"mt-1 h-4 w-4 flex-shrink-0 text-blue-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Revisa que los precios incluyan impuestos y condiciones de entrega."]}),(0,r.jsxs)("li",{className:"flex items-start gap-2",children:[(0,r.jsx)("svg",{className:"mt-1 h-4 w-4 flex-shrink-0 text-blue-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Adjunta documentos o certificaciones entregados por el proveedor."]})]})]}),(0,r.jsxs)("div",{className:"rounded-3xl border border-slate-200 bg-white p-6 text-sm text-slate-600 shadow-sm",children:[(0,r.jsx)("h3",{className:"text-sm font-semibold uppercase tracking-widest text-slate-500",children:"Proveedores disponibles"}),(0,r.jsx)("div",{className:"mt-3 space-y-3",children:m.map(e=>(0,r.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-3",children:[(0,r.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:e.name}),(0,r.jsxs)("p",{className:"text-xs text-slate-500",children:[e.email||"Sin correo"," • ",e.phone||"Sin tel\xe9fono"]})]},e.id))})]})]})]}),f&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[(0,r.jsx)("h3",{className:"text-lg font-medium mb-4",children:"Solicitar Cotizaci\xf3n"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"quoteSupplier",className:"block text-sm font-medium text-gray-700 mb-1",children:"Seleccionar Proveedor"}),(0,r.jsxs)("select",{id:"quoteSupplier",className:"w-full border rounded-md px-3 py-2",children:[(0,r.jsx)("option",{value:"",children:"Seleccione un proveedor..."}),m.map(e=>(0,r.jsxs)("option",{value:e.id,children:[e.name," - ",e.nit]},e.id))]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"quoteNotes",className:"block text-sm font-medium text-gray-700 mb-1",children:"Notas adicionales"}),(0,r.jsx)("textarea",{id:"quoteNotes",className:"w-full border rounded-md px-3 py-2 rows-3",placeholder:"Notas para el proveedor..."})]})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-2 mt-6",children:[(0,r.jsx)("button",{onClick:()=>g(!1),className:"px-4 py-2 text-gray-600 border rounded-md hover:bg-gray-50",children:"Cancelar"}),(0,r.jsx)("button",{onClick:()=>{alert("Solicitud de cotizaci\xf3n enviada"),g(!1)},className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Enviar Solicitud"})]})]})})]})})}},1518:function(e,s,t){"use strict";t.d(s,{N:function(){return i}});var r=t(8947),a=t(1960),l=t(3537);function i(e){let{currentStatus:s,compact:t=!1}=e,i=(0,l.Pe)(),n=function(e){if(!e)return -1;let s=e.toUpperCase(),t=l.bW.indexOf(s);return t>=0?t:"RECHAZADA"===s?l.bW.indexOf("EN_AUTORIZACION"):-1}(s),o=(null==s?void 0:s.toUpperCase())==="RECHAZADA";return(0,r.jsxs)("div",{className:(0,a.Z)("space-y-4",t&&"space-y-2"),children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-semibold text-gray-700",children:"Flujo del proceso"}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:s?"Estado actual: ".concat(s.replace(/_/g," ")):"Sin estado asignado"})]}),0===i.length?(0,r.jsxs)("span",{className:"inline-flex items-center gap-1 text-xs font-medium text-green-700 bg-green-100 px-2 py-1 rounded-full",children:[(0,r.jsx)("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Flujo validado"]}):(0,r.jsxs)("span",{className:"inline-flex items-center gap-1 text-xs font-medium text-red-700 bg-red-100 px-2 py-1 rounded-full",children:[(0,r.jsx)("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01M12 5a7 7 0 100 14 7 7 0 000-14z"})}),"Flujo requiere ajustes"]})]}),(0,r.jsx)("div",{className:(0,a.Z)("max-w-full overflow-x-auto pb-1 [-ms-overflow-style:none] [scrollbar-width:none] [&::-webkit-scrollbar]:hidden"),children:(0,r.jsx)("div",{className:(0,a.Z)("relative flex flex-col md:flex-row md:flex-wrap",t?"gap-3 md:gap-4":"gap-4 md:gap-6"),children:l.bW.map((e,s)=>{let i=l.A9[e],d=n>s,c=n===s&&!o;return(0,r.jsxs)("div",{className:(0,a.Z)("flex-1 min-w-[140px] md:flex-[1_1_180px]"),children:[(0,r.jsxs)("div",{className:(0,a.Z)("flex items-center gap-3 rounded-2xl border px-4 py-3 shadow-sm transition-colors",c&&"border-blue-500 bg-blue-50 text-blue-900 shadow",d&&!c&&"border-green-500 bg-green-50 text-green-900",!c&&!d&&"border-gray-200 bg-white text-gray-600"),children:[(0,r.jsx)("div",{className:(0,a.Z)("flex h-10 w-10 items-center justify-center rounded-full border-2 text-sm font-semibold",c&&"border-blue-500 bg-blue-100 text-blue-700",d&&!c&&"border-green-500 bg-green-100 text-green-700",!c&&!d&&"border-gray-200 bg-gray-100 text-gray-500"),children:s+1}),(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wider",children:i.label}),(0,r.jsx)("span",{className:"text-[11px] text-gray-500",children:i.actor})]})]}),(0,r.jsx)("p",{className:(0,a.Z)("mt-2 text-xs leading-relaxed text-gray-500",t&&"hidden md:block"),children:i.description}),o&&"EN_AUTORIZACION"===e&&(0,r.jsxs)("div",{className:"mt-2 inline-flex items-center gap-2 rounded-lg border border-red-200 bg-red-50 px-3 py-2 text-xs text-red-700",children:[(0,r.jsx)("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18.364 5.636a9 9 0 11-12.728 0 9 9 0 0112.728 0zM9 9l6 6m0-6l-6 6"})}),"Rechazada - volver a Compras"]})]},e)})})}),i.length>0&&(0,r.jsxs)("div",{className:"rounded-xl border border-red-200 bg-red-50 px-4 py-3 text-xs text-red-700",children:[(0,r.jsx)("p",{className:"font-semibold mb-1",children:"Inconsistencias detectadas en el workflow:"}),(0,r.jsx)("ul",{className:"list-disc pl-5 space-y-1",children:i.map(e=>(0,r.jsx)("li",{children:e},e))})]})]})}},1960:function(e,s,t){"use strict";s.Z=function(){for(var e,s,t=0,r="",a=arguments.length;t<a;t++)(e=arguments[t])&&(s=function e(s){var t,r,a="";if("string"==typeof s||"number"==typeof s)a+=s;else if("object"==typeof s){if(Array.isArray(s)){var l=s.length;for(t=0;t<l;t++)s[t]&&(r=e(s[t]))&&(a&&(a+=" "),a+=r)}else for(r in s)s[r]&&(a&&(a+=" "),a+=r)}return a}(e))&&(r&&(r+=" "),r+=s);return r}}},function(e){e.O(0,[747,687,45,580,996,744],function(){return e(e.s=6561)}),_N_E=e.O()}]);